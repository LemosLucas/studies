{"version":3,"sources":["../../app-src/controllers/NegociacaoController.js"],"names":["Negociacoes","NegociacaoService","Negociacao","NegociacoesView","MensagemView","Mensagem","DateConverter","getNegociacaoDao","Bind","getExceptionMessage","debounce","controller","bindEvent","NegociacaoController","_inputData","_inputQuantidade","_inputValor","Object","assign","_negociacoes","_mensagem","_service","_init","dao","listaTodos","negociacoes","forEach","negociacao","adiciona","texto","event","_criaNegociacao","_limpaFormulario","value","focus","paraData","parseInt","parseFloat","obtemNegociacoesDoPeriodo","console","log","filter","novaNegociacao","paraArray","some","negociacaoExistente","equals","apagaTodos","esvazia"],"mappings":"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","sourcesContent":["import { Negociacoes, NegociacaoService, Negociacao } from '../domain/index.js';\nimport { NegociacoesView, MensagemView, Mensagem, DateConverter } from '../ui/index.js';\nimport { getNegociacaoDao, Bind, getExceptionMessage, debounce, controller, bindEvent } from '../util/index.js';\n\n@controller('#data', '#quantidade', '#valor')\nexport class NegociacaoController {\n\n    constructor(_inputData, _inputQuantidade, _inputValor) {\n\n        Object.assign(this, { _inputData, _inputQuantidade, _inputValor })\n        \n        this._negociacoes = new Bind(\n            new Negociacoes(),\n            new NegociacoesView('#negociacoes'),\n            'adiciona', 'esvazia'\n        );\n\n        this._mensagem = new Bind(\n            new Mensagem(),\n            new MensagemView('#mensagemView'),\n            'texto'\n        );\n\n        this._service = new NegociacaoService();\n\n        this._init();\n    }\n\n    async _init() {\n\n        try {\n            const dao = await getNegociacaoDao();\n            const negociacoes = await dao.listaTodos();\n            negociacoes.forEach(negociacao => this._negociacoes.adiciona(negociacao));\n        } catch (err) {\n            this._mensagem.texto = getExceptionMessage(err);\n        }\n    }\n\n    @bindEvent('submit', '.form')\n    @debounce()\n    async adiciona(event) {\n\n        try {\n            const negociacao = this._criaNegociacao();\n            const dao = await getNegociacaoDao();\n            await dao.adiciona(negociacao);\n            this._negociacoes.adiciona(negociacao);\n            this._mensagem.texto = 'Negociação adicionada com sucesso';\n            this._limpaFormulario();\n        } catch (err) {\n            this._mensagem.texto = getExceptionMessage(err);\n        }\n    }\n\n    _limpaFormulario() {\n\n        this._inputData.value = '';\n        this._inputQuantidade.value = 1;\n        this._inputValor.value = 0.0\n        this._inputData.focus();\n    }\n\n    _criaNegociacao() {\n\n        return new Negociacao(\n            DateConverter.paraData(this._inputData.value),\n            parseInt(this._inputQuantidade.value),\n            parseFloat(this._inputValor.value)\n        );\n    }\n\n    @bindEvent('click', '#botao-importa')\n    @debounce()\n    async importaNegociacoes() {\n\n        try {\n            const negociacoes = await this._service.obtemNegociacoesDoPeriodo();\n            console.log(negociacoes);\n            negociacoes.filter(novaNegociacao =>\n\n                !this._negociacoes.paraArray().some(negociacaoExistente =>\n                    novaNegociacao.equals(negociacaoExistente)))\n                .forEach(negociacao => this._negociacoes.adiciona(negociacao));\n\n            this._mensagem.texto = 'Negociações do período importadas com sucesso';\n        } catch (err) {\n            this._mensagem.texto = getExceptionMessage(err);\n        }\n    }\n\n    @bindEvent('click', '#botao-apaga')\n    async apaga() {\n\n        try {\n            const dao = await getNegociacaoDao();\n            await dao.apagaTodos();\n            this._negociacoes.esvazia();\n            this._mensagem.texto = 'Negociações apagadas com sucesso';\n        } catch (err) {\n            this._mensagem.texto = getExceptionMessage(err);\n        }\n    }\n}"],"file":"NegociacaoController.js"}